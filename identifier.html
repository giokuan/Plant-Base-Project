<!DOCTYPE HTML>
<html>

<head>
<meta charset="UTF-8">
<link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
    integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx"
    crossorigin="anonymous"
  />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="./css/index.css" />
<title>Plant Identifier</title>
</head>

<body class="identifier">
   <!-- navbar starts here -->
<nav class="navbar fixed-top navbar-expand-lg py-4 bg-light">
      <div class="nav-container container-fluid p-0">
        <a class="navbar-brand" href="./index.html"
          ><img id="logo" src="./images/plantbase-logo.svg" alt=""
        /></a>
        <button
          class="hamburger-toggle"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span><i class="fa-solid fa-bars"></i></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="nav-link-container mx-auto mb-2 mb-lg-0">
            <li class="nav-link-items">
              <a aria-current="page" href="./index.html">Homepage</a>
            </li>
            <li class="dropdown nav-link-items">
              <a
                class="dropdown-toggle"
                href="./allplants.html"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Shop
              </a>
              <div class="shop-items dropdown-menu">
                <div class="row">
                  <div class="col-6">
                    <span><a href="./allplants.html">All Plants</a></span>
                    <span>
                      <a href="./hangingplant.html">Hanging</a>
                    </span>
                    <span><a href="./fern.html">Fern</a></span>
                    <span><a href="./bromeliad.html">Bromeliad</a></span>
                    <span>
                      <a href="./cactus.html">Cactus & Succulent</a>
                    </span>
                    <span><a href="./aglaonema.html">Aglaonema</a></span>
                    <span><a href="./other.html">Other</a></span>
                    <span><a href="./flower.html">Flower</a></span>
                    <span><a href="./foliage.html">Foliage plant</a></span>
                    <span><a href="./anthurium.html">Anthurium</a></span>
                  </div>
                  <div class="col-6">
                    <span><a href="./palm.html">Palm</a></span>
                    <span
                      ><a href="./dieffenbachia.html">Dieffenbachia</a></span
                    >
                    <span>
                      <a href="./dracaena.html">Dracaena</a>
                    </span>
                    <span>
                      <a href="./ficus.html">Ficus</a>
                    </span>
                    <span>
                      <a href="./aralia.html">Aralia</a>
                    </span>
                    <span>
                      <a href="./philodendron.html">Philodendron</a>
                    </span>
                    <span>
                      <a href="./grass.html">Grass</a>
                    </span>
                    <span>
                      <a href="./topiairy.html">Topiairy</a>
                    </span>
                    <span>
                      <a href="./sansevieria.html">Sansevieria</a>
                    </span>
                    <span>
                      <a href="./spathiphyllum.html">Spathiphyllum</a>
                    </span>
                    <span>
                      <a href="./schefflera.html">Schefflera</a>
                    </span>
                  </div>
                </div>
              </div>
            </li>
            <li class="nav-link-items">
              <a href="./blogs.html">Blogs</a>
            </li>
            <li class="nav-link-items">
              <a href="./faq.html">FAQs</a>
            </li>
            <li class="nav-link-items">
              <a href="identifier.html">Plant Identifier</a>
            </li>
            <li class="nav-link-items">
              <a href="./contact.html">Contact Us</a>
            </li>
            <!-- <li class="nav-link-items">
              <span
                ><i
                  class="bi bi-cart fa-lg cartIconNav"
                  data-bs-target="#cartModal"
                  data-bs-toggle="modal"
                  type="button"
                ></i
                >Cart
              </span>
            </li> -->
          </ul>
          <form class="search-form d-flex" role="search">
            <input
              class="search-input me-2"
              type="search"
              placeholder="Search"
            />
            <span class="search-icon"
              ><i class="fa-solid fa-magnifying-glass"></i
            ></span>
          </form>
        </div>
      </div>
    </nav>
<!-- navbar ends here -->

  <h1>PLANT BASE IDENTIFIER</h1>

     

  <div class="divForm">
  <form class="search-form" >
    <input type="file" multiple />
    <button id="search-btn" type="button" >Identify</button>
    <input class="reload" type="button" value="Reload" onClick="window.location.reload(true)">
  </form>
</div>
<div class="mainImage"></div>
  
  <hr>


 <div class="main-container">




 </div>

  <!-- newsletter section -->
  <div class="newsletter">
    <div class="newsletter-container">
      <div class="get-the-dirt-section">
        <p class="newsletter-title fs-2">Get The Dirt!</p>
        <p>Sign up and be the first to know of our newest collections.</p>
      </div>
      <form action="#" id="newsletter">
        <input
          class="newsletter-input"
          for="newsletter"
          type="email"
          placeholder="Enter Your Email"
        />
        <button class="newsletters-btn link-button" type="submit">
          SIGN UP
        </button>
      </form>
    </div>
  </div>

 <footer>
  <div class="footer-container">
    <div class="footer-logo-container">
      <a href="#"
        ><img id="logo" src="./images/plantbase-logo.svg" alt=""
      /></a>
    </div>
    <div class="footer-content-container">
      <div class="about-us-col">
        <p class="about-us-description">
              PlantBase offers a wide variety of ornamental plants that are
              great for adding flavor to your indoor or outdoor design taste. If
              you are looking for a fresh and affordable plants, this is the
              perfect place for you. We started as a small business and hobby
              and as time flies, we decided to make it through online platform.
        </p>
      </div>
      <div class="address-telephone-col">
        <ul>
          <li class="footer-content-label">ADDRESS:</li>
          <li>ABC St, Brgy. Kamote,</li>
          <li>Surigao City</li>
          <li>Philippines 8400</li>
        </ul>
        <ul>
          <li class="footer-content-label">TELEPHONE:</li>
          <li>0912-345-6789</li>
        </ul>
      </div>
      <div class="useful-links-col">
        <ul>
          <li class="footer-content-label">USEFUL LINKS</li>
          <li><a href="./allplants.html">All Plants</a></li>
          <li><a href="./blogs.html">Blogs</a></li>
          <li><a href="./contact.html">Contact Us</a></li>
          <li><a href="./faq.html">FAQs</a></li>
          <li><a href="./my-account.html">My Account</a></li>
          <li><a href="./cart.html">Cart</a></li>
          <li><a href="./checkout.html">Checkout</a></li>
        </ul>
      </div>
      <div class="social-media-col">
        <p class="footer-content-label">SOCIAL MEDIA LINKS</p>
        <div class="footer-social-media-icons">
          <span
            ><a href="#"><i class="fa-brands fa-facebook"></i></a
          ></span>
          <span
            ><a href="#"><i class="fa-brands fa-instagram"></i></a
          ></span>
          <span
            ><a href="#"><i class="fa-brands fa-twitter"></i></a
          ></span>
          <span
            ><a href="#"><i class="fa-brands fa-pinterest"></i></a
          ></span>
        </div>
        <div class="accredited-payments">
          <p class="footer-content-label">ACCREDITED PAYMENT OPTIONS</p>
          <div class="accredited-payments-logo">
            <img src="./images/GCah_2019.webp" alt="" />
            <img src="./images/mastercard.png" alt="" />
            <img src="./images/visa.png" alt="" />
            <img
              src="./images/COD_cash_on_delivery_shipping_payment_delivery-512.webp"
              alt=""
            />
          </div>
        </div>
      </div>
    </div>
  </div>
  <p class="copyright">Copyright &copy; 2022 | All Rights Reserved</p>
</footer>

 
    
 <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js"
      integrity="sha384-Xe+8cL9oJa6tN/veChSP7q+mnSPaj5Bcu9mPX5F5xIGE0DVittaqT5lorf0EI7Vk"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js"
      integrity="sha384-ODmDIVzN+pFdexxHEHFBQH3/9/vQ9uori45z4JjnFsRydbmQbmL5t1tQ0culUzyK"
      crossorigin="anonymous"
    ></script>

<script type="text/javascript">
  
document.querySelector('#search-btn').onclick = function sendIdentification() {
    const files = [...document.querySelector('input[type=file]').files];
    const promises = files.map((file) => {
      return new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.onload = (event) => {
            const res = event.target.result;
            console.log(res);
            resolve(res);
            input = "";
          }
          reader.readAsDataURL(file)
          
       
      })
    })
    
    Promise.all(promises).then((base64files) => {
      console.log(base64files)
            
      const data = {
        // api_key: 'okMbPdmE10p9YNGwgXRg57x5d1fGIubAPvS3AKBUGYBd1CaxgT',
        // api_key: 'E9v6gnIZ1pVKmewFwQ61xQ9vbNfpmUXRDMdHy1qsrnJlhOAtSq',

        api_key:'aRLxRcJm5RclUp5P3E6acUmUWCX9XjCe64qLKUyRsLsIkwBcdR', 
        // api_key:'2CYXqGzFtfjI3fbf3LFebC3YAOvJqvErUVVFiOXWx9cL2FtXDA',   kevin
        images: base64files,
        // modifiers docs: https://github.com/flowerchecker/Plant-id-API/wiki/Modifiers
        modifiers: ["crops_fast", "similar_images"],
        plant_language: "en",
        // plant details docs: https://github.com/flowerchecker/Plant-id-API/wiki/Plant-details
        plant_details: ["common_names",
                        "url",
                        "name_authority",
                        "wiki_description",
                        "taxonomy",
                        "synonyms"],
      };
      
      fetch('https://api.plant.id/v2/identify', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(data),
      })
      .then(response => response.json())
      .then(data => {
        console.log('Success:', data);
        const dataImage = data.images[0].url;
        const suggest = data.suggestions;
        // const plantDetails = data.suggestions[0].plant_details;
        // console.log(plantDetails);

      // console.log(suggest);
        // map to get similar image
        const newSuggest = suggest.map((plant)=>{
          return plant.similar_images[0].url
         
        
        })

        const newProbability = suggest.map((plant)=>{
          // return plant.similar_images[0].similarity
          return plant.probability
         
        
        })


        


        // map to get plant names
        const newplantName = suggest.map((plant)=>{
          return plant.plant_name;
        })

        // map to get commom names
        const newPlantDetails = suggest.map((details)=>{
          return details.plant_details.common_names;
        })

        // this part is to view your local uploaded photo
        // const div = document.querySelector('.main-container')
        const divForm = document.querySelector('.divForm');
        const cardImageDiv = document.createElement('div');
        cardImageDiv.classList.add('card');
        const mainImage = document.querySelector('.mainImage');

       
        
     
        const localImage = document.createElement('img');
        localImage.classList.add('localImage');
        localImage.src = dataImage;
        cardImageDiv.append(localImage);
        mainImage.append(cardImageDiv);
        // cardImageDiv.append(localImageDiv);

        for (let i=0; (i<newSuggest.length)&&(i<newplantName.length)&&(i<newPlantDetails.length)&&(i<newProbability.length); i++){
          console.log(newSuggest[i])
          console.log(newplantName[i])
   

          const getPlantName = newplantName[i];
          const getimage = newSuggest[i];
          const getPlantDetails = newPlantDetails[i];
          const getProbability = newProbability[i];

          // console.log(getSimilarity)
        
          // const getPlantDetails = info;
          const div = document.querySelector('.main-container')
          const wrapper = document.createElement('div');
          wrapper.classList.add('wrapper-wrapper')
          const mainCardDiv = document.createElement('div')
          mainCardDiv.classList.add('mainCardDiv')

           // create a new div with a class of card
          const cardDiv = document.createElement('div');
          cardDiv.classList.add('card');

          // const pDiv = document.createElement('div')
          // const cardParagraph = document.createElement('p')

          // cardParagraph.classList.add('cardParagraphClass')
          // cardParagraph.innerHTML = getPlantName;

          // pDiv.append(cardParagraph);
          
          // cardDiv.append(pDiv);

           // plant details paragraph div
           const mainPlantDetailsDiv = document.createElement('div')
          mainPlantDetailsDiv.classList.add('mainPlantDetailsDiv')

          const plantDetailsParagraph = document.createElement('p')
          plantDetailsParagraph.classList.add('plantDetails')

          const probabilityParagraph = document.createElement('p')
          probabilityParagraph.classList.add('probability')

          const plantName = document.createElement('p')
          plantName.classList.add('plantName')
          plantName.innerHTML = ('Name : ' + '' + getPlantName.toUpperCase());
          plantDetailsParagraph.innerHTML = ('Common Names :' + ' ' + getPlantDetails[0].toUpperCase());
          probabilityParagraph.innerHTML = ('Probability :' + ' ' + getProbability);
          // plantDetailsParagraph.innerHTML = (getPlantDetails[0]);
          mainPlantDetailsDiv.append(plantName);
          mainPlantDetailsDiv.append(plantDetailsParagraph);
          mainPlantDetailsDiv.append(probabilityParagraph);
         


          const image = document.createElement('img');
          image.classList.add('image-url');
          image.src=getimage;
          const newAnchor = document.createElement('a');
          newAnchor.href = newSuggest;
          newAnchor.append(image);
          cardDiv.append(newAnchor);
          mainCardDiv.append(cardDiv);
          // div.append(mainCardDiv);
          wrapper.append(mainCardDiv)
          wrapper.append(mainPlantDetailsDiv);
          div.append(wrapper)


    
        }
 
        
      })
      .catch((error) => {
        console.error('Error:', error);
      });
    })
  
};


</script>
</body>

</html>